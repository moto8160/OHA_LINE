# LineNotice プロジェクト開発ロードマップ

## プロジェクト概要

フロントエンドからTodoを登録し、指定した時間に以下の情報を含むLINEメッセージを送信するアプリケーション：

- 本日のTodo一覧
- 天気予報
- AIからの一言

---

## フェーズ 1: 基本設計・環境構築

### 1.1 データベース設計

- [ ] Todoテーブル設計
  - id, userId, title, description, scheduledTime, createdAt, updatedAt など
- [ ] ユーザーテーブル設計
  - id, lineUserId, lineToken, createdAt など
- [ ] 送信履歴テーブル設計（オプション）
  - id, userId, sentAt, content など

### 1.2 API仕様書作成

- [ ] Todo CRUD エンドポイント定義
- [ ] ユーザー認証エンドポイント定義
- [ ] スケジューラー関連エンドポイント定義

### 1.3 外部API連携準備

- [ ] LINE Messaging API の登録・認証情報取得
- [ ] 天気予報API（OpenWeatherMap など）の登録
- [ ] AIサービス（OpenAI, Claude など）の登録

---

## フェーズ 2: バックエンド実装

### 2.1 基本CRUD機能

- [ ] Todo CREATE API 実装
- [ ] Todo READ API 実装
- [ ] Todo UPDATE API 実装
- [ ] Todo DELETE API 実装
- [ ] タイムゾーン対応

### 2.2 LINE連携機能

- [ ] LINE Bot SDK の導入
- [ ] ユーザー認証（LINE ログイン）の実装
- [ ] LINE Token の保存・管理
- [ ] メッセージ送信関数の実装

### 2.3 スケジューラー実装

- [ ] Node-schedule または Bull の導入
- [ ] 定時メッセージ送信ジョブの実装
  - 指定時間に実行
  - 複数ユーザー対応
- [ ] エラーハンドリング・リトライロジック

### 2.4 天気予報API連携

- [ ] 天気予報API クライアント実装
- [ ] ユーザーの位置情報（都市）の保存
- [ ] 天気情報の取得・フォーマット

### 2.5 AI統合機能

- [ ] OpenAI / Claude SDK の導入
- [ ] AIプロンプト設計
  - 「励ましの一言」を生成するプロンプト
- [ ] AI応答の取得・キャッシング（コスト最適化）

### 2.6 メッセージ組立・送信

- [ ] テンプレート設計（メッセージ形式）
- [ ] 複数メッセージフォーマット対応（テキスト、Flex Message など）
- [ ] LINE メッセージ送信実装

### 2.7 テスト

- [ ] ユニットテスト（CRUD、ジョブなど）
- [ ] 統合テスト（APIエンドポイント）
- [ ] E2Eテスト

---

## フェーズ 3: フロントエンド実装

### 3.1 基本UI/UX

- [ ] ページレイアウト設計
  - Todo登録ページ
  - Todo一覧ページ
  - 設定ページ

### 3.2 Todo登録機能

- [ ] フォーム実装
  - Todoタイトル入力
  - 説明入力
  - 送信時刻選択
- [ ] バリデーション
- [ ] バックエンドAPI連携

### 3.3 Todo管理機能

- [ ] Todo一覧表示
- [ ] Todo編集機能
- [ ] Todo削除機能
- [ ] 検索・フィルタリング（オプション）

### 3.4 ユーザー認証UI

- [ ] LINE ログインボタン実装
- [ ] トークン管理
- [ ] ログアウト機能

### 3.5 設定ページ

- [ ] 位置情報（都市）設定
- [ ] 送信時刻デフォルト設定
- [ ] AIスタイル設定（オプション）

### 3.6 ユーザー体験向上

- [ ] ローディング画面
- [ ] エラーメッセージ表示
- [ ] 成功通知
- [ ] レスポンシブデザイン

### 3.7 テスト

- [ ] コンポーネントテスト
- [ ] E2Eテスト

---

## フェーズ 4: 統合・デプロイ

### 4.1 統合テスト

- [ ] フロントとバックエンドの統合テスト
- [ ] LINE 送信の実際のテスト
- [ ] スケジューラーの動作確認

### 4.2 環境構築

- [ ] 本番環境の環境変数設定
- [ ] データベース移行スクリプト
- [ ] Docker 本番イメージの最適化

### 4.3 デプロイ

- [ ] バックエンド デプロイ（Heroku, AWS, GCP など）
- [ ] フロントエンド デプロイ（Vercel, Netlify など）
- [ ] DNS設定

### 4.4 監視・ログ

- [ ] ログシステムの構築
- [ ] エラートラッキング（Sentry など）
- [ ] パフォーマンス監視

---

## フェーズ 5: 機能拡張・最適化

### 5.1 高度な機能

- [ ] 複数送信時刻対応
- [ ] 曜日ごとの別設定
- [ ] 休日対応
- [ ] Todoのカテゴリ分け

### 5.2 UI/UX改善

- [ ] ダークモード対応
- [ ] モバイルアプリ化（React Native など）
- [ ] オフライン対応

### 5.3 セキュリティ強化

- [ ] HTTPS強制
- [ ] CSRF対策
- [ ] レート制限
- [ ] 入力サニタイゼーション強化

### 5.4 パフォーマンス最適化

- [ ] キャッシング戦略
- [ ] クエリ最適化
- [ ] CDN活用

---

## 実装優先度ガイド

### 必須（MVP）

1. Todoの登録・削除機能
2. LINE認証
3. スケジューラー基本実装
4. 定時メッセージ送信

### 重要

5. 天気予報統合
6. AIからの一言機能
7. フロント Todo管理UI

### 拡張

8. 複数時刻送信
9. UIの高度なカスタマイズ
10. パフォーマンス最適化

---

## 技術スタック確認

### バックエンド

- [ ] NestJS（既存）
- [ ] PostgreSQL（Docker）
- [ ] Node-schedule または Bull（スケジューラー）
- [ ] LINE Bot SDK
- [ ] Axios または node-fetch（API呼び出し）
- [ ] Jest（テスト）

### フロントエンド

- [ ] Next.js（既存）
- [ ] React
- [ ] TypeScript
- [ ] CSS または Tailwind CSS

### 外部サービス

- [ ] LINE Messaging API
- [ ] 天気予報API（OpenWeatherMap など）
- [ ] AI API（OpenAI / Claude など）

---

## 開発リソース・期間目安

| フェーズ  | 見積り期間 | 優先度        |
| --------- | ---------- | ------------- |
| フェーズ1 | 1-2日      | 🔴 必須       |
| フェーズ2 | 3-5日      | 🔴 必須       |
| フェーズ3 | 2-4日      | 🔴 必須       |
| フェーズ4 | 1-2日      | 🟡 重要       |
| フェーズ5 | 継続的     | 🟢 オプション |

---

## チェックリスト使用法

各セクションの `[ ]` をチェック（✅）することで進捗を管理できます。
定期的にこのドキュメントを更新して進捗を可視化してください。
